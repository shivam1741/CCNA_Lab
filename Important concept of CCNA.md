# Packets Sent During Network Communication (For Notes)

This note explains **all types of packets** that are exchanged when a device communicates with another device **inside the same network** and **outside the network**.

## 1. Communication Inside the Same Network (Same LAN)

**Example:**

* PC1: 192.168.1.10
* PC2: 192.168.1.20
* Same subnet

### Step-by-step Packet Flow

### I. ARP (Address Resolution Protocol)

* Sent when the **MAC address of the destination is unknown**
* ARP Request: Broadcast (Who has this IP?)
* ARP Reply: Unicast (Here is my MAC address)
* Happens only once until ARP cache expires


### II. Data / Control Packets (After ARP completes)

Depending on the type of communication:

* ICMP → Used for ping and reachability check
* TCP → Used for reliable communication (HTTP, HTTPS, FTP, SSH)
* UDP → Used for fast communication (DNS, video streaming, VoIP)

All these packets are **unicast** inside the LAN.


### III. Switch Control Packets (Background)

* STP (BPDU packets)
* Sent between switches only
* Used to prevent switching loops
* Not related to user data traffic


### Summary (Inside Network)

* ARP → Finds MAC address
* ICMP / TCP / UDP → Actual communication
* STP → Switch management (background)

---

## 2. Communication Outside the Network (Different Subnet / Internet)

**Example:**

* PC: 192.168.1.10
* Default Gateway: 192.168.1.1
* Destination: 8.8.8.8


### Step-by-step Packet Flow

### I. ARP (For Default Gateway)

* PC does NOT ARP for the destination IP
* PC sends ARP Request for the default gateway MAC
* Router replies with its MAC address


### II. DNS (If Domain Name Is Used)

* DNS Query sent to DNS server (UDP port 53)
* DNS Response returns destination IP address
* Happens before TCP/ICMP communication


### III. Data / Control Packets

Depending on the activity:

* ICMP → Ping to external device
* TCP → Web browsing, secure login, file transfer
* UDP → Streaming, online calls

Packets are sent to the router, then forwarded to the destination network.


### IV. Routing Protocol Packets (Router-level)

* RIP, OSPF, EIGRP
* Used between routers to select best path
* Not generated by end devices

### V. NAT Processing (If Configured)

* Source IP address is translated
* Packet structure remains same, header is modified

### Summary (Outside Network)

* ARP → Finds default gateway MAC
* DNS → Resolves domain name to IP
* ICMP / TCP / UDP → Data communication
* Routing → Path selection
* NAT → Address translation

---

## 3. Complete Packet Type List (Layer-wise)

### Layer 2 (Data Link Layer)

* ARP
* STP (BPDU)
* Ethernet Frame

### Layer 3 (Network Layer)

* IP
* ICMP

### Layer 4 (Transport Layer)

* TCP
* UDP

### Application Layer

* DNS
* HTTP / HTTPS
* FTP
* SMTP
* SSH
* DHCP

## Key Exam Points (CCNA)

* First packet in LAN communication → ARP
* First packet for Internet communication → ARP (Gateway)
* Before website opens → DNS
* Reachability check → ICMP
* Loop prevention → STP


**Golden Rule:**
ARP enables communication, DNS finds IPs, TCP/UDP transfer data, ICMP tests the network.

----

## NOTE
### Does a switch send STP without any command?
✅ YES

### Why does a switch send STP automatically?   
A switch sends STP to:
* Check whether other switches are connected
* Prevent Layer-2 loops
* Decide which port should block or forward
* Maintain a loop-free topology
* So yes, it is always checking the network, even if there is no loop right now.

### When exactly does a switch send STP by default?   
Without any command, a switch sends BPDU packets:
* When the switch powers on
* Every 2 seconds (hello time)
* When a topology change occurs
* When redundant paths exist

### Important CCNA facts

* Default STP is enabled
* Default mode on Cisco switches is PVST+
* STP runs on all VLANs
* STP works at Layer 2
* STP uses BPDUs, not IP packets

### What if there is only ONE switch?

* Switch still sends BPDUs
* It considers itself Root Bridge
* No port is blocked

### When does STP NOT send packets?

* If STP is manually disabled
(not recommended)
* End devices (PCs, servers) never send STP

### One-line exam answer
> A switch sends STP BPDUs by default to detect loops and maintain a stable Layer-2 network.

